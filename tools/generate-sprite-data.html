<!DOCTYPE html>
<html>
<head>
  <title>Sprite Data Generator</title>
</head>
<body>
  <pre style="padding:0;margin:0;" id="content"></pre>
  <script src="../js/third-party/jquery-1.12.0.min.js"></script>
  <script>

    // Hard-coded hair and skin colors.
    var spriteData = {
      hairColors: {
        blonde: {
          light: { r: 248, g: 232, b: 176 },
          med:   { r: 225, g: 192, b: 112 },
          dark:  { r: 160, g: 127, b: 87  }
        },
        brown: {
          light: { r: 207, g: 160,  b: 112 },
          med:   { r: 160, g: 120,  b: 80  },
          dark:  { r: 96,  g: 72,   b: 64  }
        },
        chocolate: {
          light: { r: 144, g: 112, b: 80 },
          med:   { r: 96,  g: 80,  b: 56 },
          dark:  { r: 56,  g: 48,  b: 48 }
        },
        black: {
          light: { r: 112, g: 118, b: 136 },
          med:   { r: 81,  g: 80,  b: 96  },
          dark:  { r: 55,  g: 56,  b: 64  }
        },
        ginger: {
          light: { r: 233,  g: 117, b: 67 },
          med:   { r: 210,  g: 83,  b: 47 },
          dark:  { r: 153,  g: 41,  b: 20 }
        }
      },
      skinTones: {
        pale: {
          shine: { r: 232, g: 232, b: 248 },
          light: { r: 248, g: 208, b: 184 },
          ear:   { r: 232, g: 176, b: 128 },
          med:   { r: 216, g: 152, b: 112 },
          dark:  { r: 120, g: 64,  b: 64  }
        },
        tan: {
          shine: { r: 245, g: 175, b: 147 },
          light: { r: 216, g: 152, b: 112 },
          ear:   { r: 216, g: 152, b: 112 },
          med:   { r: 177, g: 125, b: 92  },
          dark:  { r: 89,  g: 58,  b: 47  }
        },
        ebony: {
          shine: { r: 157, g: 112, b: 94 },
          light: { r: 129, g: 92,  b: 77 },
          ear:   { r: 129, g: 92,  b: 77 },
          med:   { r: 83,  g: 60,  b: 50 },
          dark:  { r: 33,  g: 24,  b: 20  }
        }
      }
    }
    // Build a string to display to the page.
    var spriteDataStr = "var spriteData = " 
      + JSON.stringify(spriteData, null, 2) 
      + "\n\nvar imageData = {\n";

    // Create a canvas to use.
    var canvas = document.createElement("canvas");
    canvas.width = 23 * 4;
    canvas.height = 29 * 4;
    var context = canvas.getContext("2d");

    /**
      Loads an individual player file and adds it's imageData to our display string.
      @param file The filename to load.
    **/
    function loadFile(folder, file) {
      // Log the file being loaded.
      console.log("loading file:", folder + "/" + file + ".png");

      // Create a promise that will resolve when the image is loaded.
      var imagePromise = new Promise(function(resolve, reject) {
        var image = new Image();
        image.onload = function() {
          context.drawImage(image, 0, 0);
          var imageData = context.getImageData(0, 0, canvas.width, canvas.height).data;
          context.clearRect(0, 0, canvas.width, canvas.height);

          resolve("    \"" + file + "\": [" + imageData);
        }
        image.src = "../img/player/" + folder + "/" + file + ".png";

      // Upon resolution, add imageData to our string.
      }).then(function(value) {
        spriteDataStr += value + "],\n";
      });      
    }

    // Hair style files.
    var hairFiles = ["bald", "hair-1", "hair-2", "hair-3"];
    for (var f = 0; f < hairFiles.length; f++) {
      loadFile("hair", hairFiles[f]);
    }

    // Outfit files.
    var outfitFiles = ["dress", "vest"];
    for (var f = 0; f < outfitFiles.length; f++) {
      loadFile("outfits", outfitFiles[f]);
    }

    // Not the best set up, but wait a second (for images to all load) and display data.
    // Should probably be a promise, but yolo.
    setTimeout(function() {
      $("#content").html(
        spriteDataStr 
        + "}\n"
        + "spriteData.imageData = imageData;");
    }, 1000);
  </script>
</body>
</html>